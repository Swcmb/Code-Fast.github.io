<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>
<div class="article-intro" id="content">
			
			
<h2>函数指针</h2>&#13;
<p>函数指针是指向函数的指针变量。</p>&#13;
<p>通常我们说的指针变量是指向一个整型、字符型或数组等变量，而函数指针是指向函数。</p>&#13;
<p>函数指针可以像一般函数一样，用于调用函数、传递参数。</p>&#13;
<p>函数指针类型的声明：</p>&#13;
<pre>&#13;
typedef int (*fun_ptr)(int,int); // 声明一个指向同样参数、返回值的函数指针类型&#13;
</pre>&#13;
<h3>实例</h3>&#13;
<p>以下实例声明了函数指针变量 p，指向函数 max：</p>&#13;
<div class="example">&#13;
<h2 class="example">实例</h2>&#13;
<div class="example_code">&#13;
<div class="hl-main"><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">stdio.h</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"/><span class="hl-code">
 
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">max</span><span class="hl-brackets">(</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">x</span><span class="hl-code">, </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">y</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">x</span><span class="hl-code"> &gt; </span><span class="hl-identifier">y</span><span class="hl-code"> ? </span><span class="hl-identifier">x</span><span class="hl-code"> : </span><span class="hl-identifier">y</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-code">
 
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-mlcomment">/*</span><span class="hl-mlcomment"> p 是函数指针 </span><span class="hl-mlcomment">*/</span><span class="hl-code">
    </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-code">* </span><span class="hl-identifier">p</span><span class="hl-brackets">)</span><span class="hl-brackets">(</span><span class="hl-types">int</span><span class="hl-code">, </span><span class="hl-types">int</span><span class="hl-brackets">)</span><span class="hl-code"> = &amp; </span><span class="hl-identifier">max</span><span class="hl-code">; </span><span class="hl-comment">// &amp;可以省略</span><span class="hl-comment"/><span class="hl-code">
    </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">a</span><span class="hl-code">, </span><span class="hl-identifier">b</span><span class="hl-code">, </span><span class="hl-identifier">c</span><span class="hl-code">, </span><span class="hl-identifier">d</span><span class="hl-code">;
 
    </span><span class="hl-identifier">printf</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">请输入三个数字:</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">scanf</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">%d %d %d</span><span class="hl-quotes">"</span><span class="hl-code">, &amp; </span><span class="hl-identifier">a</span><span class="hl-code">, &amp; </span><span class="hl-identifier">b</span><span class="hl-code">, &amp; </span><span class="hl-identifier">c</span><span class="hl-brackets">)</span><span class="hl-code">;
 
    </span><span class="hl-mlcomment">/*</span><span class="hl-mlcomment"> 与直接调用函数等价，d = max(max(a, b), c) </span><span class="hl-mlcomment">*/</span><span class="hl-code">
    </span><span class="hl-identifier">d</span><span class="hl-code"> = </span><span class="hl-identifier">p</span><span class="hl-brackets">(</span><span class="hl-identifier">p</span><span class="hl-brackets">(</span><span class="hl-identifier">a</span><span class="hl-code">, </span><span class="hl-identifier">b</span><span class="hl-brackets">)</span><span class="hl-code">, </span><span class="hl-identifier">c</span><span class="hl-brackets">)</span><span class="hl-code">; 
 
    </span><span class="hl-identifier">printf</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">最大的数字是: %d</span><span class="hl-special">\</span><span class="hl-string">n</span><span class="hl-quotes">"</span><span class="hl-code">, </span><span class="hl-identifier">d</span><span class="hl-brackets">)</span><span class="hl-code">;
 
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;
</span><span class="hl-brackets">}</span></div>&#13;
</div></div>&#13;
<p>编译执行，输出结果如下：</p>&#13;
<pre>&#13;
请输入三个数字:1 2 3&#13;
最大的数字是: 3&#13;
</pre>&#13;
<hr/><h2>回调函数&#13;
</h2>&#13;
<h3>函数指针作为某个函数的参数</h3>&#13;
<p/>&#13;
<p>函数指针变量可以作为某个函数的参数来使用的，回调函数就是一个通过函数指针调用的函数。</p>&#13;
<p>简单讲：回调函数是由别人的函数执行时调用你实现的函数。</p>&#13;
<blockquote>&#13;
<p>以下是来自知乎作者常溪玲的解说：</p>&#13;
<p>你到一个商店买东西，刚好你要的东西没有货，于是你在店员那里留下了你的电话，过了几天店里有货了，店员就打了你的电话，然后你接到电话后就到店里去取了货。在这个例子里，你的电话号码就叫回调函数，你把电话留给店员就叫登记回调函数，店里后来有货了叫做触发了回调关联的事件，店员给你打电话叫做调用回调函数，你到店里去取货叫做响应回调事件。&#13;
</p></blockquote>&#13;
<h3>实例</h3>&#13;
<p>实例中 <strong>populate_array()</strong> 函数定义了三个参数，其中第三个参数是函数的指针，通过该函数来设置数组的值。</p>&#13;
<p>实例中我们定义了回调函数 <strong>getNextRandomValue()</strong>，它返回一个随机值，它作为一个函数指针传递给 <strong>populate_array()</strong> 函数。</p>&#13;
<p><strong>populate_array()</strong> 将调用 <strong>10</strong> 次回调函数，并将回调函数的返回值赋值给数组。</p>&#13;
&#13;
<div class="example">&#13;
<h2 class="example">实例</h2>&#13;
<div class="example_code">&#13;
<div class="hl-main"><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">stdlib.h</span><span class="hl-quotes">&gt;</span><span class="hl-prepro">  </span><span class="hl-prepro"/><span class="hl-code">
</span><span class="hl-prepro">#include</span><span class="hl-prepro"> </span><span class="hl-quotes">&lt;</span><span class="hl-string">stdio.h</span><span class="hl-quotes">&gt;</span><span class="hl-prepro"/><span class="hl-code">
 
</span><span class="hl-types">void</span><span class="hl-code"> </span><span class="hl-identifier">populate_array</span><span class="hl-brackets">(</span><span class="hl-types">int</span><span class="hl-code"> *</span><span class="hl-identifier">array</span><span class="hl-code">, </span><span class="hl-identifier">size_t</span><span class="hl-code"> </span><span class="hl-identifier">arraySize</span><span class="hl-code">, </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-code">*</span><span class="hl-identifier">getNextValue</span><span class="hl-brackets">)</span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-brackets">)</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">for</span><span class="hl-code"> </span><span class="hl-brackets">(</span><span class="hl-identifier">size_t</span><span class="hl-code"> </span><span class="hl-identifier">i</span><span class="hl-code">=</span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">&lt;</span><span class="hl-identifier">arraySize</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">++</span><span class="hl-brackets">)</span><span class="hl-code">
        </span><span class="hl-identifier">array</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">getNextValue</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-code">
 
</span><span class="hl-comment">// 获取随机值</span><span class="hl-comment"/><span class="hl-code">
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">getNextRandomValue</span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-identifier">rand</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-code">
 
</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">main</span><span class="hl-brackets">(</span><span class="hl-types">void</span><span class="hl-brackets">)</span><span class="hl-code">
</span><span class="hl-brackets">{</span><span class="hl-code">
    </span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">myarray</span><span class="hl-brackets">[</span><span class="hl-number">10</span><span class="hl-brackets">]</span><span class="hl-code">;
    </span><span class="hl-mlcomment">/*</span><span class="hl-mlcomment"> getNextRandomValue 不能加括号，否则无法编译，因为加上括号之后相当于传入此参数时传入了 int , 而不是函数指针</span><span class="hl-mlcomment">*/</span><span class="hl-code">
    </span><span class="hl-identifier">populate_array</span><span class="hl-brackets">(</span><span class="hl-identifier">myarray</span><span class="hl-code">, </span><span class="hl-number">10</span><span class="hl-code">, </span><span class="hl-identifier">getNextRandomValue</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-types">int</span><span class="hl-code"> </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &lt; </span><span class="hl-number">10</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">++</span><span class="hl-brackets">)</span><span class="hl-code"> </span><span class="hl-brackets">{</span><span class="hl-code">
        </span><span class="hl-identifier">printf</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-string">%d </span><span class="hl-quotes">"</span><span class="hl-code">, </span><span class="hl-identifier">myarray</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
    </span><span class="hl-identifier">printf</span><span class="hl-brackets">(</span><span class="hl-quotes">"</span><span class="hl-special">\</span><span class="hl-string">n</span><span class="hl-quotes">"</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">return</span><span class="hl-code"> </span><span class="hl-number">0</span><span class="hl-code">;
</span><span class="hl-brackets">}</span></div>&#13;
</div></div>&#13;
<p>编译执行，输出结果如下：</p>&#13;
<pre>&#13;
16807 282475249 1622650073 984943658 1144108930 470211272 101027544 1457850878 1458777923 2007237709 &#13;
</pre>&#13;
&#13;
&#13;
&#13;
			<!-- 其他扩展 -->
						
			</div>
			
		
</body>
</html>